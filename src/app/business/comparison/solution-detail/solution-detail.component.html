<button id='create-btn' routerLink='../create' mat-fab color="primary">
    <mat-icon>add</mat-icon>
</button>

<ng-template #loadingTemp>
    <div ogms-loading>
        <mat-spinner></mat-spinner>
    </div>
</ng-template>

<ogms-detail-layout *ngIf='solution else loadingTemp'>
    <div class='header-title' [class.read]='titleMode === "READ"'>
        <ng-container *ngIf='titleMode === "WRITE" else readTemp'>
            <span class='topic-name'>
                <mat-form-field>
                    <input matInput placeholder='Topic Name' [(ngModel)]='solution.meta.name' required minlength="5">
                    <mat-error *ngIf='"required"'>必填</mat-error>
                    <mat-error *ngIf='"minlength"'>长度不够</mat-error>
                </mat-form-field>
            </span>
            <div class='title-btn-group'>
                <button mat-button color='primary' (click)='onTitleEditSave()'>Save</button>
                <button mat-button color='primary' (click)='onTitleEditCancel()'>Cancel</button>
            </div>
        </ng-container>
        <ng-template #readTemp>
            <h2>{{solution.meta.name}}</h2>
            <div class='title-btn-group'>
                <button mat-button color='primary' *ngIf='couldEdit' (click)='onTitleEditClick()'>Edit</button>
                <!-- <button mat-flat-button color='primary' *ngIf='couldEdit' [routerLink]='["../create"]'>New Topic</button> -->
            </div>
        </ng-template>
    </div>

    <div class='header-meta'>
        <a class='author' routerLink='/user'>{{solution.auth.userName}}</a> created this topic at {{solution.meta.time
        |
        date: 'yyyy.MM.dd'}}
    </div>

    <div class='article'>
        <mat-tab-group>
            <mat-tab label='Wiki'>
                <div class='wiki-tab' *ngIf='descMode === "WRITE"'>
                    <simplemde [(ngModel)]='solution.meta.descMD' [options]='mdeOption'></simplemde>
                    <div class='desc-btn-group'>
                        <button mat-button color='primary' (click)='onDescEditCancel()'>Cancel</button>
                        <button mat-button color='primary' (click)='onDescEditSave()'>Save</button>
                    </div>
                </div>
                <div class='wiki-tab' *ngIf='descMode === "READ"'>
                    <div [innerHTML]='solution.meta.descHTML'></div>
                    <div class='desc-btn-group'>
                        <button mat-button color='primary' *ngIf='couldEdit' (click)='onDescEditClick()'>Edit</button>
                    </div>
                </div>
            </mat-tab>

            <mat-tab label='Configuration'>

            </mat-tab>

            <mat-tab label='Conversation'>
                <ogms-conversation [ngModel]='conversation'></ogms-conversation>
            </mat-tab>
        </mat-tab-group>
    </div>

    <div class='aside'>

    </div>
</ogms-detail-layout>
